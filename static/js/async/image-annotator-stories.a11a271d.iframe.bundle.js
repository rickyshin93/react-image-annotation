"use strict";(self.webpackChunk_rockshin_react_image_annotation=self.webpackChunk_rockshin_react_image_annotation||[]).push([["904"],{"./stories/image-annotator.stories.ts":function(e,t,a){a.r(t),a.d(t,{WithMixedSizeImages:()=>S,WithPreExistingAnnotations:()=>w,WithCallbacks:()=>A,WithAutoTriggers:()=>C,WithSmallImage:()=>j,WithLargeImage:()=>E,WithFailedImageLoad:()=>N,WithMultipleImages:()=>I,default:()=>f,__namedExportsOrder:()=>k,WithCustomTools:()=>v,Basic:()=>y}),a("./node_modules/.pnpm/tldraw@3.6.1_@types+react@18.3.18_react-dom@18.3.1_react@18.3.1/node_modules/tldraw/tldraw.css");var n=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),o=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),r=a("./node_modules/.pnpm/tldraw@3.6.1_@types+react@18.3.18_react-dom@18.3.1_react@18.3.1/node_modules/tldraw/dist-esm/index.mjs"),s=a("./src/components/loading/index.tsx");let i=e=>{let{onClick:t}=e;return(0,n.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg z-[300] font-bold pointer-events-auto hover:bg-blue-600 m-2",onClick:t,children:"Done"})};i.__docgenInfo={description:"",methods:[],displayName:"CustomDoneButton",props:{onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};var l=a("./node_modules/.pnpm/react-icons@5.4.0_react@18.3.1/node_modules/react-icons/gr/index.mjs");let d=e=>(0,n.jsxs)("div",{className:"flex h-10 z-[300] pointer-events-auto bg-[var(--color-low)] py-1 px-2 rounded-b-lg gap-2",children:[(0,n.jsx)("button",{className:"flex-none w-10 cursor-pointer px-2 hover:bg-[#00000010] rounded-lg",onClick:e.onPrevious,children:(0,n.jsx)(l.o8k,{color:"#2E2E2E",size:24})}),(0,n.jsxs)("span",{className:"flex items-center justify-center text-sm font-medium text-[var(--color-text-1)]",children:[e.currentIndex," / ",e.totalCount]}),(0,n.jsx)("button",{className:"flex-none w-10 cursor-pointer px-2 hover:bg-[#00000010] rounded-lg",onClick:e.onNext,children:(0,n.jsx)(l.zSJ,{className:"",size:24,color:"var(--color-text-1)"})})]});d.__docgenInfo={description:"",methods:[],displayName:"TopPanel",props:{onPrevious:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onNext:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},currentIndex:{required:!0,tsType:{name:"number"},description:""},totalCount:{required:!0,tsType:{name:"number"},description:""}}};let c=async e=>{let t;if(e.startsWith("data:")){let a=e.split(",")[1],n=e.split(",")[0].split(":")[1].split(";")[0],o=atob(a),r=new ArrayBuffer(o.length),s=new Uint8Array(r);for(let e=0;e<o.length;e++)s[e]=o.charCodeAt(e);t=new Blob([r],{type:n})}else t=await fetch(e).then(e=>e.blob());let a=await r.P60.blobToDataUrl(t),{w:n,h:o}=await r.xeI.getImageSize(t);return{src:a,width:n,height:o,type:t.type}};function m(e,t){if(!e)return;let a=e.getShape(t);if(!a)return;let n=e.getCurrentPageId();a.parentId!==n&&e.moveShapesToPage([a],n);let o=e.getSortedChildIdsForParent(n);e.getShape(o[0]).id!==t&&e.sendToBack([a])}let p=e=>{if(!e)return[];let t=[];return e.getCurrentPageShapes().forEach(e=>{if("geo"===e.type&&"rectangle"===e.props.geo){let a={x:e.x,y:e.y,width:e.props.w,height:e.props.h},n={id:e.id,x:a.x,y:a.y,width:a.width,height:a.height,rotation:e.rotation||0,type:"rectangle",label:e.props.text||"",timestamp:Date.now(),metadata:{color:e.props.color||"default",createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}};t.push(n)}}),t},u=async e=>{try{if(e.startsWith("data:image/")){let[t,a]=e.split(",");if(!t.includes("base64")||!a)throw Error("Invalid base64 image format")}else new URL(e)}catch(e){if(e instanceof Error&&"Invalid base64 image format"===e.message)throw e;throw Error("Invalid image URL")}let t=new Promise((e,t)=>{setTimeout(()=>t(Error("Image load timed out")),3e4)});try{return await Promise.race([c(e),t])}catch(e){if(e instanceof Error){if("Image load timed out"===e.message)throw Error(`Failed to load image within ${30} seconds`);if(e.message.includes("Failed to fetch")||e.message.includes("NetworkError"))throw Error("Network error: Unable to load image");if(e.message.includes("base64"))throw Error("Invalid base64 image data")}throw Error("Failed to load image")}},g=async e=>{let{imageIndex:t,images:a,setIsLoading:n,setImageLoadError:o,setImage:s,setUsedNumbers:i,setDeletedNumbers:l,onImageLoadError:d}=e;try{n(!0),o(null);let e=await u(a[t].src);s({...e,id:a[t].id||(0,r.ELf)()});let d=new Set;a[t].annotations.forEach(e=>{if(e.label){let t=parseInt(e.label);!isNaN(t)&&d.add(t)}}),i(d),l([])}catch(n){let e=n instanceof Error?n:Error("Failed to load image");console.error("Failed to load image:",e),o(e),null==d||d(e,{id:a[t].id||"",src:a[t].src,index:t})}finally{n(!1)}};function h(e){let{images:t,tools:a,initialImageIndex:l=0,outputTriggerOn:c,onDone:u,onAnnotationCreated:h,onAnnotationChange:f,onAnnotationDeleted:x,onImageChange:b,onImageLoadError:y}=e;if(0===t.length)return(0,n.jsx)("div",{children:"Please provided at least one image"});let{eraser:w,text:v}=a||{},[A,C]=(0,o.useState)(null),[I,E]=(0,o.useState)(null),[j,S]=(0,o.useState)(l<t.length?l:0),[N,k]=(0,o.useState)(null),[T,_]=(0,o.useState)(new Set),[D,q]=(0,o.useState)([]),W=(0,o.useRef)(!1),V=(0,o.useRef)(0),[P,L]=(0,o.useState)(!1),[B,F]=(0,o.useState)(null);(0,o.useEffect)(()=>{g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:k,setUsedNumbers:_,setDeletedNumbers:q,onImageLoadError:y})},[j,t,y]);(0,o.useEffect)(()=>{I&&A&&N&&t[j].annotations.forEach(e=>{var t,a;let n=e.id||(0,r.F17)();I.createShape({id:n,type:"geo",x:e.x,y:e.y,rotation:e.rotation,props:{geo:"rectangle",w:e.width,h:e.height,text:e.label||"",color:(null===(t=e.metadata)||void 0===t?void 0:t.color)||"default",labelColor:(null===(a=e.metadata)||void 0===a?void 0:a.color)||"default"}})})},[I,A,N]);let R=(0,o.useCallback)(async()=>{if(!I||!N)return;let e=p(I);null==u||u({annotations:e,image:{id:N.id,src:t[j].src}})},[u,I,N,t,j]),z=()=>{if(D.length>0){let e=Math.min(...D);return q(t=>t.filter(t=>t!==e)),_(t=>{let a=new Set(t);return a.add(e),a}),e.toString()}let e=1;for(;T.has(e);)e++;return e>999?(console.warn("Exceeded maximum number of annotations (999)"),"999"):(_(t=>{let a=new Set(t);return a.add(e),a}),e.toString())};(0,o.useEffect)(()=>{if(!I)return;let e=null,t=()=>{if(e){let t=I.getShape(e);if(t&&"geo"===t.type&&"rectangle"===t.props.geo){let e=z();I.updateShape({id:t.id,type:"geo",props:{...t.props,labelColor:"red",text:e}});let a={id:t.id,x:t.x,y:t.y,width:t.props.w,height:t.props.h,rotation:t.rotation||0,label:e,timestamp:Date.now(),metadata:{color:t.props.color,createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}};null==h||h({image:{id:null==N?void 0:N.id},annotation:a}),(null==c?void 0:c.created)&&R()}e=null}},a=async(t,a)=>{if(W.current)return;let{prev:n}=a||{};if(!n||n.id===e)return;let o=Date.now();if("change"===t&&o-V.current<50)return;V.current=o;let r={id:n.id,x:n.x,y:n.y,width:n.props.w,height:n.props.h,rotation:n.rotation,label:n.props.text,timestamp:Date.now(),metadata:{color:n.props.color,createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}};if("delete"===t){let e=parseInt(n.props.text);!isNaN(e)&&(q(t=>[...t,e].sort((e,t)=>e-t)),_(t=>{let a=new Set(t);return a.delete(e),a})),null==x||x({image:{id:null==N?void 0:N.id},annotation:r}),(null==c?void 0:c.deleted)&&R()}else"change"===t&&(null==f||f({image:{id:null==N?void 0:N.id},annotation:r}),(null==c?void 0:c.changed)&&R())},n=(0,r.DsO)(()=>{R()},50),o=(0,r.DsO)(a,100),s=I.sideEffects.registerAfterCreateHandler("shape",t=>{"geo"===t.type&&"rectangle"===t.props.geo&&(e=t.id)}),i=I.sideEffects.registerAfterChangeHandler("shape",(e,t)=>o("change",{prev:e,next:t})),l=I.sideEffects.registerAfterDeleteHandler("shape",e=>a("delete",{prev:e}));return I.on("event",e=>{"pointer_up"===e.name&&t()}),()=>{s(),i(),l(),n.cancel(),o.cancel()}},[I,A,p,R,z]),(0,o.useEffect)(()=>{if(!I||!N)return;let e=r.Ykc.createId();I.createAssets([{id:e,typeName:"asset",type:"image",meta:{},props:{w:N.width,h:N.height,mimeType:N.type,src:N.src,name:`image-${e}`,isAnimated:!1}}]);let t=(0,r.F17)();I.createShape({id:t,type:"image",x:0,y:0,isLocked:!0,props:{w:N.width,h:N.height,assetId:e}});let a=I.sideEffects.registerAfterCreateHandler("shape",()=>m(I,t)),n=I.sideEffects.registerAfterChangeHandler("shape",()=>m(I,t)),o=I.sideEffects.registerBeforeChangeHandler("shape",(e,a)=>a.id!==t||a.isLocked?a:{...e,isLocked:!0});return I.clearHistory(),C(t),()=>{n(),a(),o()}},[I,null==N?void 0:N.id]),(0,o.useEffect)(()=>{I&&N&&A&&(I.setCameraOptions({constraints:{initialZoom:"fit-max-100",baseZoom:"default",bounds:{w:N.width,h:N.height,x:0,y:0},padding:{x:16,y:16},origin:{x:.5,y:.5},behavior:"free"},zoomSteps:[.5,1,2,4,8],zoomSpeed:1,panSpeed:1,isLocked:!1}),I.setCamera(I.getCamera(),{reset:!0}))},[I,A,N]);let H=(0,o.useCallback)(e=>{W.current=!0,S(a=>"prev"===e?0===a?t.length-1:a-1:a===t.length-1?0:a+1),null==I||I.run(()=>{null==I||I.deleteShapes(Array.from(I.getCurrentPageShapeIds()))},{ignoreShapeLock:!0}),C(null),setTimeout(()=>{W.current=!1},100)},[I,t.length]),O=(0,o.useCallback)(()=>H("prev"),[H]),M=(0,o.useCallback)(()=>H("next"),[H]);return(0,o.useEffect)(()=>{null==b||b({index:j,image:{id:t[j].id||"",src:t[j].src}})},[j]),(0,o.useEffect)(()=>{W.current&&I&&N&&setTimeout(()=>{R()},100)},[j]),(0,o.useEffect)(()=>{W.current&&(k(null),(async()=>{try{L(!0),F(null),await g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:k,setUsedNumbers:_,setDeletedNumbers:q,onImageLoadError:y})}catch(e){}finally{L(!1)}})())},[j,t,y,W.current]),(0,n.jsxs)("div",{className:"absolute inset-0",children:[B&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-50",children:(0,n.jsxs)("div",{className:"text-center p-4",children:[(0,n.jsxs)("div",{className:"text-red-600 mb-4",children:[(0,n.jsx)("span",{className:"mr-2",children:`Failed to load image ${j+1} of ${t.length}:`}),(0,n.jsx)("span",{className:"text-gray-600",children:B.message})]}),(0,n.jsxs)("div",{className:"space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:k,setUsedNumbers:_,setDeletedNumbers:q,onImageLoadError:y})},className:"px-4 py-2 rounded-3xl border border-blue-500 text-blue-500 hover:bg-blue-50 leading-[24px]",children:"Retry"}),j>0&&(0,n.jsx)("button",{onClick:()=>O(),className:"px-4 py-2 bg-blue-500 text-white rounded-3xl hover:bg-blue-600",children:"Prev Image"}),j<t.length-1&&(0,n.jsx)("button",{onClick:()=>M(),className:"px-4 py-2 bg-blue-500 text-white rounded-3xl hover:bg-blue-600",children:"Next Images"})]})]})}),P&&(0,n.jsx)("div",{className:"absolute top-12 bottom-12 left-0 right-0 flex items-center justify-center z-50",children:(0,n.jsx)(s.Z,{isLoading:!0,loadingText:`Loading image ${j+1} of ${t.length}...`,className:"w-[300px] bg-gradient-to-r from-blue-50 to-sky-50",loadingSpinnerClassName:"border-blue-500",progressBarClassName:"bg-gradient-to-r from-blue-500 to-sky-500"})}),(0,n.jsx)(r.DrV,{onMount:function(e){E(e),e.setStyleForNextShapes(r.R_W,"red"),e.setStyleForNextShapes(r.ST$,"s"),e.setStyleForNextShapes(r.Y8S,"mono")},components:{Toolbar:e=>{let t=(0,r.b55)(),a=(0,r.EA)(t.select),o=(0,r.EA)(t.rectangle),s=(0,r.EA)(t.text),i=(0,r.EA)(t.eraser),l=(0,r.EA)(t.hand);return(0,n.jsxs)(r.DhQ,{...e,children:[(0,n.jsx)(r.hEi,{...t.select,isSelected:a}),(0,n.jsx)(r.hEi,{...t.hand,isSelected:l}),(null==w?void 0:w.enabled)&&(0,n.jsx)(r.hEi,{...t.eraser,isSelected:i}),(null==v?void 0:v.enabled)&&(0,n.jsx)(r.hEi,{...t.text,isSelected:s}),(0,n.jsx)(r.hEi,{...t.rectangle,isSelected:o})]})},PageMenu:null,ActionsMenu:null,StylePanel:null,TopPanel:(0,o.useCallback)(()=>(0,n.jsx)(d,{onPrevious:O,onNext:M,currentIndex:j+1,totalCount:t.length}),[A,u,j]),SharePanel:(0,o.useCallback)(()=>(0,n.jsx)(i,{onClick:R}),[A,i])}})]})}h.__docgenInfo={description:"",methods:[],displayName:"ImageAnnotationEditor",props:{images:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{\n  id?: string\n  src: string\n  annotations: Annotation[]\n}",signature:{properties:[{key:"id",value:{name:"string",required:!1}},{key:"src",value:{name:"string",required:!0}},{key:"annotations",value:{name:"Array",elements:[{name:"Annotation"}],raw:"Annotation[]",required:!0}}]}}],raw:"{\n  id?: string\n  src: string\n  annotations: Annotation[]\n}[]"},description:""},initialImageIndex:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},tools:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  eraser?: {\n    enabled?: boolean\n  }\n  text?: {\n    enabled?: boolean\n  }\n}",signature:{properties:[{key:"eraser",value:{name:"signature",type:"object",raw:"{\n  enabled?: boolean\n}",signature:{properties:[{key:"enabled",value:{name:"boolean",required:!1}}]},required:!1}},{key:"text",value:{name:"signature",type:"object",raw:"{\n  enabled?: boolean\n}",signature:{properties:[{key:"enabled",value:{name:"boolean",required:!1}}]},required:!1}}]}},description:""},outputTriggerOn:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  created?: boolean\n  changed?: boolean\n  deleted?: boolean\n}",signature:{properties:[{key:"created",value:{name:"boolean",required:!1}},{key:"changed",value:{name:"boolean",required:!1}},{key:"deleted",value:{name:"boolean",required:!1}}]}},description:""},onImageLoadError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error: Error, image: { id: string; src: string; index: number }) => void",signature:{arguments:[{type:{name:"Error"},name:"error"},{type:{name:"signature",type:"object",raw:"{ id: string; src: string; index: number }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"src",value:{name:"string",required:!0}},{key:"index",value:{name:"number",required:!0}}]}},name:"image"}],return:{name:"void"}}},description:""}}};let f={title:"Components/ImageAnnotator",component:h,parameters:{layout:"centered",docs:{description:{component:`
# Image Annotation Editor

A powerful React component for annotating images with shapes, text, and custom tools.

## Features

- 🎯 Auto-incrementing numbered annotations (1-999)
- 🖼️ Multi-image support with navigation
- 🔄 Automatic reuse of deleted annotation numbers
- 🎨 Customizable toolbar with:
  - Rectangle tool
  - Text tool (optional)
  - Eraser tool (optional)
  - Hand tool for navigation
- 📊 Comprehensive event callbacks
- 🖼️ Support for both URL and base64 image sources
- 🔄 Automatic image fitting with aspect ratio preservation
- ⚡ Real-time annotation updates
- 🔒 Locked base image to prevent accidental movement

## Installation

\`\`\`bash
npm install @your-package/image-annotator
\`\`\`

\`\`\`bash
yarn add @your-package/image-annotator
\`\`\`

\`\`\`bash
pnpm add @your-package/image-annotator
\`\`\`

## Basic Usage

\`\`\`tsx
import { ImageAnnotationEditor } from '@your-package/image-annotator'

function App() {
  return (
    <ImageAnnotationEditor
      images={[
        {
          id: 'image1',
          src: 'path/to/image.jpg',
          annotations: []
        }
      ]}
      onDone={(data) => console.log('Annotations:', data)}
    />
  )
}
\`\`\`
        `}}},argTypes:{images:{description:"Array of images with their annotations",control:"object"},tools:{description:"Configuration for annotation tools",control:"object"},outputTriggerOn:{description:"Configure when to trigger output callbacks",control:"object"},initialImageIndex:{description:"Initial image to display (zero-based index)",control:"number"},onAnnotationCreated:{description:"Callback when a new annotation is created",control:!1},onAnnotationChange:{description:"Callback when an annotation is modified",control:!1},onAnnotationDeleted:{description:"Callback when an annotation is deleted",control:!1},onImageChange:{description:"Callback when switching between images",control:!1},onDone:{description:"Callback when annotation is complete",control:!1}},tags:["autodocs"]},x=[{id:"image0",src:"https://fastly.picsum.photos/id/930/900/600.jpg?hmac=-VvyG-XjlLRggW6xtMd4UHBwxXJ-O8g7EVRpKm9DW0s",annotations:[{id:"shape:s-MMqyY_DlysR5i_Dr-cw",x:570.6616220075775,y:234.7749303606369,width:198.69671630859375,height:131.31036376953125,rotation:5.3756140961425345,type:"rectangle",label:"5",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:1-yh2opbFbOpEprcNPdKS",x:83.45930325359515,y:193.02561725714776,width:124.84748947006867,height:123.61206136850944,rotation:5.3756140961425345,type:"rectangle",label:"1",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:Hp9GrZ00ldwLN0CpWkcXY",x:154.38957623531536,y:305.0142249484778,width:248.734083670453,height:229.15347678557805,rotation:0,type:"rectangle",label:"2",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:sw4HvspZ2ScsJ68k6Ejm7",x:451.2897707321237,y:142.1256360707238,width:129.70425985164417,height:108.62586997703193,rotation:5.3930673886624785,type:"rectangle",label:"3",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:cPtiRk5d-0bboKDQSoMO9",x:586.2918704226382,y:368.4326594858195,width:278.90842602679845,height:142.37716236564358,rotation:.29670597283903605,type:"rectangle",label:"4",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:5NSqVehqe8IlFmYaW7PsP",x:308.8582223671702,y:260.60060508073525,width:154.5696085710519,height:182.23682110566017,rotation:0,type:"rectangle",label:"6",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}}]},{id:"image1",src:"https://fastly.picsum.photos/id/106/900/600.jpg?hmac=xA_tP1jGHJrWhLPmViP6lnLck6pqCmDXQP8Q9H1IPgs",annotations:[]},{id:"image2",src:"https://fastly.picsum.photos/id/574/800/601.jpg?hmac=DZb2oYbpWGCSpPwqhs4_H0Uvk2VoizaQWddhQIVhRFE",annotations:[]},{id:"image3",src:"https://fastly.picsum.photos/id/372/800/600.jpg?hmac=911lXwSe0NWznaFWKm3nVrZV7y1IypKxlpDUIVpKxVs",annotations:[]},{id:"image4",src:"https://fastly.picsum.photos/id/1057/800/600.jpg?hmac=YmA5NCeEgXc1TOldOXFtXzaMW1NWH-IG92zNgLmTcDQ",annotations:[]},{id:"image5",src:"https://fastly.picsum.photos/id/705/900/600.jpg?hmac=bzZzT6Zhu_ybVXbEhA8WipVgd9fxGXYNmZgaApMKHBY",annotations:[]}],b=[{id:"image1",src:"https://fastly.picsum.photos/id/727/800/602.jpg?hmac=TXud4Hami5cc6oxCzbuVUHoTIeP-nNVcU8A1VtS11XE",annotations:[{id:"shape:1",x:100,y:100,width:200,height:150,rotation:0,label:"1",timestamp:Date.now(),metadata:{color:"red",createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}}]}],y={args:{images:x},parameters:{docs:{description:{story:`
### Basic Example

This is the most basic usage of the Image Annotator component. It shows:
- Loading multiple images
- Basic annotation capabilities
- Default tool configuration
        `}}}},w={args:{images:b}},v={args:{images:x,tools:{eraser:{enabled:!0},text:{enabled:!0}}},parameters:{docs:{description:{story:`
### Custom Tools Example

Demonstrates how to configure custom tools:
\`\`\`tsx
<ImageAnnotationEditor
  tools={{
    eraser: { enabled: true },
    text: { enabled: true }
  }}
/>
\`\`\`
        `}}}},A={args:{images:x,outputTriggerOn:{created:!0,changed:!0,deleted:!0},onAnnotationCreated:e=>{console.log("Annotation created:",e)},onAnnotationChange:e=>{console.log("Annotation changed:",e)},onAnnotationDeleted:e=>{console.log("Annotation deleted:",e)},onImageChange:e=>{console.log("Image changed:",e)},onDone:e=>{console.log("Done clicked:",e)}},parameters:{docs:{description:{story:`
### Callback Events Example

Shows how to handle various events:
\`\`\`tsx
<ImageAnnotationEditor
  outputTriggerOn={{
    created: true,
    changed: true,
    deleted: true
  }}
  onAnnotationCreated={(annotation) => {
    console.log('New annotation:', annotation)
  }}
  onDone={(data) => {
    console.log('Final annotations:', data)
  }}
/>
\`\`\`
        `}}}},C={args:{images:x,outputTriggerOn:{created:!0,changed:!0,deleted:!0},onDone:e=>{console.log("Auto-triggered on change:",e)}}},I={args:{images:[,,,,,].fill(null).map((e,t)=>({id:`image${t+1}`,src:`https://picsum.photos/800/${600+t}`,annotations:[]})),initialImageIndex:0}},E={args:{images:[{id:"large-image",src:"https://picsum.photos/2000/1500",annotations:[]}]}},j={args:{images:[{id:"small-image",src:"https://picsum.photos/400/300",annotations:[]}]}},S={args:{images:[{id:"small",src:"https://picsum.photos/400/300",annotations:[]},{id:"medium",src:"https://picsum.photos/800/600",annotations:[]},{id:"large",src:"https://picsum.photos/1600/1200",annotations:[]}]}},N={args:{initialImageIndex:1,images:[{id:"valid-image",src:"https://picsum.photos/800/600",annotations:[]},{id:"failed-image",src:"https://invalid-image-url.jpg",annotations:[]},{id:"valid-image",src:"https://picsum.photos/800/600",annotations:[]}]}},k=["Basic","WithPreExistingAnnotations","WithCustomTools","WithCallbacks","WithAutoTriggers","WithMultipleImages","WithLargeImage","WithSmallImage","WithMixedSizeImages","WithFailedImageLoad"];y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Basic Example\n\nThis is the most basic usage of the Image Annotator component. It shows:\n- Loading multiple images\n- Basic annotation capabilities\n- Default tool configuration\n        `\n      }\n    }\n  }\n}",...y.parameters?.docs?.source}}},w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: imagesWithAnnotations\n  }\n}",...w.parameters?.docs?.source}}},v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    tools: {\n      eraser: {\n        enabled: true\n      },\n      text: {\n        enabled: true\n      }\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Custom Tools Example\n\nDemonstrates how to configure custom tools:\n\\`\\`\\`tsx\n<ImageAnnotationEditor\n  tools={{\n    eraser: { enabled: true },\n    text: { enabled: true }\n  }}\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}",...v.parameters?.docs?.source}}},A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    outputTriggerOn: {\n      created: true,\n      changed: true,\n      deleted: true\n    },\n    onAnnotationCreated: annotation => {\n      console.log('Annotation created:', annotation);\n    },\n    onAnnotationChange: annotation => {\n      console.log('Annotation changed:', annotation);\n    },\n    onAnnotationDeleted: annotation => {\n      console.log('Annotation deleted:', annotation);\n    },\n    onImageChange: data => {\n      console.log('Image changed:', data);\n    },\n    onDone: data => {\n      console.log('Done clicked:', data);\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Callback Events Example\n\nShows how to handle various events:\n\\`\\`\\`tsx\n<ImageAnnotationEditor\n  outputTriggerOn={{\n    created: true,\n    changed: true,\n    deleted: true\n  }}\n  onAnnotationCreated={(annotation) => {\n    console.log('New annotation:', annotation)\n  }}\n  onDone={(data) => {\n    console.log('Final annotations:', data)\n  }}\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}",...A.parameters?.docs?.source}}},C.parameters={...C.parameters,docs:{...C.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    outputTriggerOn: {\n      created: true,\n      changed: true,\n      deleted: true\n    },\n    onDone: data => {\n      console.log('Auto-triggered on change:', data);\n    }\n  }\n}",...C.parameters?.docs?.source}}},I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: Array(5).fill(null).map((_, i) => ({\n      id: `image${i + 1}`,\n      src: `https://picsum.photos/800/${600 + i}`,\n      annotations: []\n    })),\n    initialImageIndex: 0\n  }\n}",...I.parameters?.docs?.source}}},E.parameters={...E.parameters,docs:{...E.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'large-image',\n      src: 'https://picsum.photos/2000/1500',\n      annotations: []\n    }]\n  }\n}",...E.parameters?.docs?.source}}},j.parameters={...j.parameters,docs:{...j.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'small-image',\n      src: 'https://picsum.photos/400/300',\n      annotations: []\n    }]\n  }\n}",...j.parameters?.docs?.source}}},S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'small',\n      src: 'https://picsum.photos/400/300',\n      annotations: []\n    }, {\n      id: 'medium',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }, {\n      id: 'large',\n      src: 'https://picsum.photos/1600/1200',\n      annotations: []\n    }]\n  }\n}",...S.parameters?.docs?.source}}},N.parameters={...N.parameters,docs:{...N.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialImageIndex: 1,\n    images: [{\n      id: 'valid-image',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }, {\n      id: 'failed-image',\n      // Using an invalid URL to simulate a failed image load\n      src: 'https://invalid-image-url.jpg',\n      annotations: []\n    }, {\n      id: 'valid-image',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }]\n  }\n}",...N.parameters?.docs?.source}}}},"./src/components/loading/index.tsx":function(e,t,a){a.d(t,{Z:()=>u});var n=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),o=a("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),r=a("./node_modules/.pnpm/motion@11.17.0_react-dom@18.3.1_react@18.3.1/node_modules/motion/dist/es/framer-motion/dist/es/render/components/motion/proxy.mjs"),s=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");let i=100,l=2,d=300,c=90,m="Loading...",p=!0;function u(e){let{loadingText:t=m,className:a="",content:u="",children:g,isLoading:h=!1,progressInterval:f=i,progressIncrement:x=l,expandDelay:b=d,maxAutoProgress:y=c,autoProgress:w=p,contentClassName:v="",loadingSpinnerClassName:A="",progressBarClassName:C=""}=e,[I,E]=(0,s.useState)({progress:0,showContent:!1,expanded:!1}),j=(0,s.useRef)(null),[S,N]=(0,s.useState)(0);return(0,s.useEffect)(()=>{h?E({progress:0,showContent:!1,expanded:!1}):(u||g)&&(E(e=>({...e,showContent:!0})),setTimeout(()=>{E(e=>({...e,expanded:!0}))},b))},[h,u,g,b]),(0,s.useEffect)(()=>{if(!w||!h)return;let e=setInterval(()=>{E(e=>({...e,progress:e.progress>=y?y:e.progress+x}))},f);return()=>clearInterval(e)},[h,w,y,x,f]),(0,s.useEffect)(()=>{!h&&I.progress<100&&E(e=>({...e,progress:100}))},[h]),(0,s.useEffect)(()=>{j.current&&N(j.current.scrollHeight+32)},[I.showContent]),(0,n.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,n.jsx)("div",{className:"transition-all duration-500 ease-out transform",children:(0,n.jsx)(r.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:(0,o.W)("relative bg-white overflow-hidden","transition-all duration-500 ease-in-out",I.showContent?"rounded-[16px] border border-[#e5e7eb]":"rounded-2xl border border-[#e5e7eb]",I.expanded?"transform-none":"scale-95 opacity-90","shadow-sm",I.showContent&&"animate-expand-width",a),style:{height:I.expanded?S||"auto":"40px"},children:(0,n.jsx)("div",{className:(0,o.W)("px-6 flex items-center h-full justify-between","transition-all duration-500 ease-in-out",I.showContent&&"animate-slide-content",I.showContent&&"py-4"),children:I.showContent?g?(0,n.jsx)("div",{ref:j,className:(0,o.W)("w-full transition-all duration-500 ease-in-out",I.expanded?"opacity-100":"opacity-0",v),children:g}):u?(0,n.jsx)("div",{ref:j,className:(0,o.W)("w-full transition-all duration-500 ease-in-out",I.expanded?"opacity-100":"opacity-0",v),children:(0,n.jsx)("div",{className:"prose prose-gray max-w-none py-4",children:u.split("\n\n").map((e,t)=>(0,n.jsx)("p",{className:"mb-4 text-[#181b25] leading-relaxed",children:e},t))})}):null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("span",{className:"text-[14px] font-medium text-[#181b25] whitespace-nowrap",children:t})}),(0,n.jsx)(r.E.div,{className:(0,o.W)("h-4 w-4 border-2 border-[#9672e4] border-t-transparent rounded-full ml-3",A),animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),(0,n.jsx)("div",{className:(0,o.W)("absolute bottom-0 left-0 h-[2px] bg-gradient-to-r from-[#9672e4] to-[#e0daff] transition-all duration-100",C),style:{width:`${I.progress}%`}})]})})})})})}u.__docgenInfo={description:"",methods:[],displayName:"Loading",props:{loadingText:{required:!1,tsType:{name:"string"},description:"Text displayed during the loading state",defaultValue:{value:"'Loading...'",computed:!1}},className:{required:!1,tsType:{name:"string"},description:"Additional className for the main container",defaultValue:{value:"''",computed:!1}},content:{required:!1,tsType:{name:"string"},description:"Content to display after loading completes. Can be a string or React nodes",defaultValue:{value:"''",computed:!1}},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React nodes to display after loading completes"},isLoading:{required:!1,tsType:{name:"boolean"},description:"Controls the loading state",defaultValue:{value:"false",computed:!1}},progressInterval:{required:!1,tsType:{name:"number"},description:"Interval (in ms) between progress updates. Default: 100",defaultValue:{value:"100",computed:!1}},progressIncrement:{required:!1,tsType:{name:"number"},description:"Amount to increment progress by each interval. Default: 2",defaultValue:{value:"2",computed:!1}},expandDelay:{required:!1,tsType:{name:"number"},description:"Delay (in ms) before expanding the container to show content. Default: 300",defaultValue:{value:"300",computed:!1}},maxAutoProgress:{required:!1,tsType:{name:"number"},description:"Maximum progress value for auto-progress. Default: 90",defaultValue:{value:"90",computed:!1}},autoProgress:{required:!1,tsType:{name:"boolean"},description:"Enable/disable automatic progress animation. Default: true",defaultValue:{value:"true",computed:!1}},contentClassName:{required:!1,tsType:{name:"string"},description:"Additional className for the content container",defaultValue:{value:"''",computed:!1}},loadingSpinnerClassName:{required:!1,tsType:{name:"string"},description:"Additional className for the loading spinner",defaultValue:{value:"''",computed:!1}},progressBarClassName:{required:!1,tsType:{name:"string"},description:"Additional className for the progress bar",defaultValue:{value:"''",computed:!1}}}}}}]);