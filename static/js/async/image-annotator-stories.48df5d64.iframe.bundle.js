"use strict";(self.webpackChunk_rockshin_react_image_annotation=self.webpackChunk_rockshin_react_image_annotation||[]).push([["904"],{"./stories/image-annotator.stories.ts":function(e,t,a){a.r(t),a.d(t,{WithCustomMetadata:()=>V,WithMixedSizeImages:()=>S,WithCallbacks:()=>A,WithAutoTriggers:()=>I,WithPreExistingAnnotations:()=>w,WithSmallImage:()=>j,WithLargeImage:()=>N,WithFailedImageLoad:()=>D,WithMultipleImages:()=>E,default:()=>x,__namedExportsOrder:()=>k,WithCustomTools:()=>C,Basic:()=>v}),a("./node_modules/.pnpm/tldraw@3.7.2_@types+react@18.3.18_react-dom@18.3.1_react@18.3.1/node_modules/tldraw/tldraw.css");var n=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),o=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),i=a("./node_modules/.pnpm/tldraw@3.7.2_@types+react@18.3.18_react-dom@18.3.1_react@18.3.1/node_modules/tldraw/dist-esm/index.mjs"),s=a("./src/components/loading/index.tsx");let r=e=>{let{onClick:t}=e;return(0,n.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg z-[300] font-bold pointer-events-auto hover:bg-blue-600 m-2",onClick:t,children:"Done"})};try{r.displayName="CustomDoneButton",r.__docgenInfo={description:"",displayName:"CustomDoneButton",props:{onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}}}catch(e){}var d=a("./node_modules/.pnpm/react-icons@5.4.0_react@18.3.1/node_modules/react-icons/gr/index.mjs");let l=e=>(0,n.jsxs)("div",{className:"flex h-10 z-[300] pointer-events-auto bg-[var(--color-low)] py-1 px-2 rounded-b-lg gap-2",children:[(0,n.jsx)("button",{className:"flex-none w-10 cursor-pointer px-2 hover:bg-[#00000010] rounded-lg",onClick:e.onPrevious,children:(0,n.jsx)(d.o8k,{color:"#2E2E2E",size:24})}),(0,n.jsxs)("span",{className:"flex items-center justify-center text-sm font-medium text-[var(--color-text-1)]",children:[e.currentIndex," / ",e.totalCount]}),(0,n.jsx)("button",{className:"flex-none w-10 cursor-pointer px-2 hover:bg-[#00000010] rounded-lg",onClick:e.onNext,children:(0,n.jsx)(d.zSJ,{className:"",size:24,color:"var(--color-text-1)"})})]});try{l.displayName="TopPanel",l.__docgenInfo={description:"",displayName:"TopPanel",props:{onPrevious:{defaultValue:null,description:"",name:"onPrevious",required:!0,type:{name:"() => void"}},onNext:{defaultValue:null,description:"",name:"onNext",required:!0,type:{name:"() => void"}},currentIndex:{defaultValue:null,description:"",name:"currentIndex",required:!0,type:{name:"number"}},totalCount:{defaultValue:null,description:"",name:"totalCount",required:!0,type:{name:"number"}}}}}catch(e){}let c=async e=>{let t;if(e.startsWith("data:")){let a=e.split(",")[1],n=e.split(",")[0].split(":")[1].split(";")[0],o=atob(a),i=new ArrayBuffer(o.length),s=new Uint8Array(i);for(let e=0;e<o.length;e++)s[e]=o.charCodeAt(e);t=new Blob([i],{type:n})}else t=await fetch(e).then(e=>e.blob());let a=await i.P60.blobToDataUrl(t),{w:n,h:o}=await i.xeI.getImageSize(t);return{src:a,width:n,height:o,type:t.type}};function m(e,t){if(!e)return;let a=e.getShape(t);if(!a)return;let n=e.getCurrentPageId();a.parentId!==n&&e.moveShapesToPage([a],n);let o=e.getSortedChildIdsForParent(n);e.getShape(o[0]).id!==t&&e.sendToBack([a])}let u=e=>{if(!e)return[];let t=[];return e.getCurrentPageShapes().forEach(e=>{if("geo"===e.type&&"rectangle"===e.props.geo){let a={x:e.x,y:e.y,width:e.props.w,height:e.props.h},n={id:e.id,x:a.x,y:a.y,width:a.width,height:a.height,rotation:e.rotation||0,type:"rectangle",label:e.props.text||"",timestamp:Date.now(),metadata:{color:e.props.color||"default",createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}};t.push(n)}}),t},p=async e=>{try{if(e.startsWith("data:image/")){let[t,a]=e.split(",");if(!t.includes("base64")||!a)throw Error("Invalid base64 image format")}else new URL(e)}catch(e){if(e instanceof Error&&"Invalid base64 image format"===e.message)throw e;throw Error("Invalid image URL")}let t=new Promise((e,t)=>{setTimeout(()=>t(Error("Image load timed out")),3e4)});try{return await Promise.race([c(e),t])}catch(e){if(e instanceof Error){if("Image load timed out"===e.message)throw Error("Failed to load image within 30 seconds");if(e.message.includes("Failed to fetch")||e.message.includes("NetworkError"))throw Error("Network error: Unable to load image");if(e.message.includes("base64"))throw Error("Invalid base64 image data")}throw Error("Failed to load image")}},g=async e=>{let{imageIndex:t,images:a,setIsLoading:n,setImageLoadError:o,setImage:s,setUsedNumbers:r,setDeletedNumbers:d,onImageLoadError:l}=e;try{n(!0),o(null);let e=await p(a[t].src);s({...e,id:a[t].id||(0,i.ELf)()});let l=new Set;a[t].annotations.forEach(e=>{if(e.label){let t=parseInt(e.label);isNaN(t)||l.add(t)}}),r(l),d([])}catch(n){let e=n instanceof Error?n:Error("Failed to load image");console.error("Failed to load image:",e),o(e),null==l||l(e,{id:a[t].id||"",src:a[t].src,index:t})}finally{n(!1)}},h=e=>{null==e||e.run(()=>{null==e||e.deleteShapes(Array.from(e.getCurrentPageShapeIds()))},{ignoreShapeLock:!0})};function f(e){let{images:t,tools:a,initialImageIndex:d=0,outputTriggerOn:c,onDone:p,onAnnotationCreated:f,onAnnotationChange:x,onAnnotationDeleted:y,onImageChange:b,onImageLoadError:v}=e;if(0===t.length)return(0,n.jsx)("div",{children:"Please provided at least one image"});let{eraser:w,text:C}=a||{},[A,I]=(0,o.useState)(null),[E,N]=(0,o.useState)(null),[j,S]=(0,o.useState)(d<t.length?d:0),[D,V]=(0,o.useState)(null),[k,_]=(0,o.useState)(new Set),[T,W]=(0,o.useState)([]),P=(0,o.useRef)(!1),B=(0,o.useRef)(0),[q,L]=(0,o.useState)(!1),[M,F]=(0,o.useState)(null);(0,o.useEffect)(()=>{g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:V,setUsedNumbers:_,setDeletedNumbers:W,onImageLoadError:v})},[j,t,v]),(0,o.useEffect)(()=>{E&&A&&D&&t[j].annotations.forEach(e=>{var t,a;let n=e.id||(0,i.F17)();E.createShape({id:n,type:"geo",x:e.x,y:e.y,rotation:e.rotation,props:{geo:"rectangle",w:e.width,h:e.height,text:e.label||"",color:(null===(t=e.metadata)||void 0===t?void 0:t.color)||"default",labelColor:(null===(a=e.metadata)||void 0===a?void 0:a.color)||"default"}})})},[E,A,D]);let z=(0,o.useCallback)(async()=>{if(!E||!D)return;let e=u(E);null==p||p({annotations:e,image:{id:D.id,src:t[j].src}})},[p,E,D,t,j]),H=()=>{if(T.length>0){let e=Math.min(...T);return W(t=>t.filter(t=>t!==e)),_(t=>{let a=new Set(t);return a.add(e),a}),e.toString()}let e=1;for(;k.has(e);)e++;return e>999?(console.warn("Exceeded maximum number of annotations (999)"),"999"):(_(t=>{let a=new Set(t);return a.add(e),a}),e.toString())};(0,o.useEffect)(()=>{if(!E)return;let e=null,a=()=>{if(e){let t=E.getShape(e);if(t&&"geo"===t.type&&"rectangle"===t.props.geo){let e=H();E.updateShape({id:t.id,type:"geo",props:{...t.props,labelColor:"red",text:e}});let a={id:t.id,x:t.x,y:t.y,width:t.props.w,height:t.props.h,rotation:t.rotation||0,label:e,timestamp:Date.now(),metadata:{color:t.props.color,createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}};null==f||f({image:{id:null==D?void 0:D.id},annotation:a}),(null==c?void 0:c.created)&&z()}e=null}},n=async(a,n)=>{var o,i,s,r;if(P.current)return;let{prev:d}=n||{};if(!d||d.id===e)return;let l=Date.now();if("change"===a&&l-B.current<50)return;B.current=l;let m=t[j].annotations.find(e=>e.id===d.id),u={id:d.id,x:d.x,y:d.y,width:d.props.w,height:d.props.h,rotation:d.rotation,label:d.props.text,timestamp:Date.now(),metadata:{...(null==m?void 0:m.metadata)||{},color:d.props.color,modifiedAt:Date.now(),createdBy:(null==m?void 0:null===(o=m.metadata)||void 0===o?void 0:o.createdBy)||"user",version:(null==m?void 0:null===(i=m.metadata)||void 0===i?void 0:i.version)||1,tags:(null==m?void 0:null===(s=m.metadata)||void 0===s?void 0:s.tags)||[],isVerified:(null==m?void 0:null===(r=m.metadata)||void 0===r?void 0:r.isVerified)??!1}};if("delete"===a){let e=parseInt(d.props.text);isNaN(e)||(W(t=>[...t,e].sort((e,t)=>e-t)),_(t=>{let a=new Set(t);return a.delete(e),a})),null==y||y({image:{id:null==D?void 0:D.id},annotation:u}),(null==c?void 0:c.deleted)&&z()}else"change"===a&&(null==x||x({image:{id:null==D?void 0:D.id},annotation:u}),(null==c?void 0:c.changed)&&z())},o=(0,i.DsO)(()=>{z()},50),s=(0,i.DsO)(n,100),r=E.sideEffects.registerAfterCreateHandler("shape",t=>{"geo"===t.type&&"rectangle"===t.props.geo&&(e=t.id)}),d=E.sideEffects.registerAfterChangeHandler("shape",(e,t)=>s("change",{prev:e,next:t})),l=E.sideEffects.registerAfterDeleteHandler("shape",e=>n("delete",{prev:e}));return E.on("event",e=>{"pointer_up"===e.name&&a()}),()=>{r(),d(),l(),o.cancel(),s.cancel()}},[E,A,u,z,H]),(0,o.useEffect)(()=>{if(!E||!D)return;let e=i.Ykc.createId();E.createAssets([{id:e,typeName:"asset",type:"image",meta:{},props:{w:D.width,h:D.height,mimeType:D.type,src:D.src,name:`image-${e}`,isAnimated:!1}}]);let t=(0,i.F17)();E.createShape({id:t,type:"image",x:0,y:0,isLocked:!0,props:{w:D.width,h:D.height,assetId:e}});let a=E.sideEffects.registerAfterCreateHandler("shape",()=>m(E,t)),n=E.sideEffects.registerAfterChangeHandler("shape",()=>m(E,t)),o=E.sideEffects.registerBeforeChangeHandler("shape",(e,a)=>a.id!==t||a.isLocked?a:{...e,isLocked:!0});return E.clearHistory(),I(t),()=>{n(),a(),o()}},[E,null==D?void 0:D.id]),(0,o.useEffect)(()=>{E&&D&&A&&(E.setCameraOptions({constraints:{initialZoom:"fit-max-100",baseZoom:"default",bounds:{w:D.width,h:D.height,x:0,y:0},padding:{x:16,y:16},origin:{x:.5,y:.5},behavior:"free"},zoomSteps:[.5,1,2,4,8],zoomSpeed:1,panSpeed:1,isLocked:!1}),E.setCamera(E.getCamera(),{reset:!0}))},[E,A,D]);let O=(0,o.useCallback)(e=>{!(t.length<=1)&&E&&(P.current=!0,h(E),S(a=>"prev"===e?0===a?t.length-1:a-1:a===t.length-1?0:a+1),I(null),setTimeout(()=>{P.current=!1},100))},[E,t.length]),R=(0,o.useCallback)(()=>O("prev"),[O]),U=(0,o.useCallback)(()=>O("next"),[O]);return(0,o.useEffect)(()=>{null==b||b({index:j,image:{id:t[j].id||"",src:t[j].src}})},[j]),(0,o.useEffect)(()=>{P.current&&E&&D&&(null==c?void 0:c.navigated)&&(h(E),setTimeout(()=>{z()},100))},[j,null==c?void 0:c.navigated]),(0,o.useEffect)(()=>{P.current&&(V(null),(async()=>{try{L(!0),F(null),await g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:V,setUsedNumbers:_,setDeletedNumbers:W,onImageLoadError:v})}catch(e){}finally{L(!1)}})())},[j,t,v,P.current]),(0,n.jsxs)("div",{className:"absolute inset-0",children:[M&&(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50 z-50",children:(0,n.jsxs)("div",{className:"text-center p-4",children:[(0,n.jsxs)("div",{className:"text-red-600 mb-4",children:[(0,n.jsx)("span",{className:"mr-2",children:`Failed to load image ${j+1} of ${t.length}:`}),(0,n.jsx)("span",{className:"text-gray-600",children:M.message})]}),(0,n.jsxs)("div",{className:"space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{g({imageIndex:j,images:t,setIsLoading:L,setImageLoadError:F,setImage:V,setUsedNumbers:_,setDeletedNumbers:W,onImageLoadError:v})},className:"px-4 py-2 rounded-3xl border border-blue-500 text-blue-500 hover:bg-blue-50 leading-[24px]",children:"Retry"}),j>0&&(0,n.jsx)("button",{onClick:()=>R(),className:"px-4 py-2 bg-blue-500 text-white rounded-3xl hover:bg-blue-600",children:"Prev Image"}),j<t.length-1&&(0,n.jsx)("button",{onClick:()=>U(),className:"px-4 py-2 bg-blue-500 text-white rounded-3xl hover:bg-blue-600",children:"Next Images"})]})]})}),q&&(0,n.jsx)("div",{className:"absolute top-12 bottom-12 left-0 right-0 flex items-center justify-center z-50",children:(0,n.jsx)(s.Z,{isLoading:!0,loadingText:`Loading image ${j+1} of ${t.length}...`,className:"w-[300px] bg-gradient-to-r from-blue-50 to-sky-50",loadingSpinnerClassName:"border-blue-500",progressBarClassName:"bg-gradient-to-r from-blue-500 to-sky-500"})}),(0,n.jsx)(i.DrV,{onMount:function(e){N(e),e.setStyleForNextShapes(i.R_W,"red"),e.setStyleForNextShapes(i.ST$,"s"),e.setStyleForNextShapes(i.Y8S,"mono")},components:{Toolbar:e=>{let t=(0,i.b55)(),a=(0,i.EA)(t.select),o=(0,i.EA)(t.rectangle),s=(0,i.EA)(t.text),r=(0,i.EA)(t.eraser),d=(0,i.EA)(t.hand);return(0,n.jsxs)(i.DhQ,{...e,children:[(0,n.jsx)(i.hEi,{...t.select,isSelected:a}),(0,n.jsx)(i.hEi,{...t.hand,isSelected:d}),(null==w?void 0:w.enabled)&&(0,n.jsx)(i.hEi,{...t.eraser,isSelected:r}),(null==C?void 0:C.enabled)&&(0,n.jsx)(i.hEi,{...t.text,isSelected:s}),(0,n.jsx)(i.hEi,{...t.rectangle,isSelected:o})]})},PageMenu:null,ActionsMenu:null,StylePanel:null,TopPanel:(0,o.useCallback)(()=>(0,n.jsx)(l,{onPrevious:R,onNext:U,currentIndex:j+1,totalCount:t.length}),[A,p,j,t.length]),SharePanel:(0,o.useCallback)(()=>(0,n.jsx)(r,{onClick:z}),[A,r])}})]})}try{f.displayName="ImageAnnotationEditor",f.__docgenInfo={description:"",displayName:"ImageAnnotationEditor",props:{images:{defaultValue:null,description:"",name:"images",required:!0,type:{name:"{ id?: string | undefined; src: string; annotations: Annotation[]; }[]"}},initialImageIndex:{defaultValue:{value:"0"},description:"",name:"initialImageIndex",required:!1,type:{name:"number"}},tools:{defaultValue:null,description:"",name:"tools",required:!1,type:{name:"{ eraser?: { enabled?: boolean; }; text?: { enabled?: boolean | undefined; } | undefined; } | undefined"}},outputTriggerOn:{defaultValue:null,description:"",name:"outputTriggerOn",required:!1,type:{name:"{ created?: boolean; changed?: boolean; deleted?: boolean | undefined; navigated?: boolean | undefined; } | undefined"}},onDone:{defaultValue:null,description:"",name:"onDone",required:!1,type:{name:"((result: IOnDoneEvent) => void)"}},onAnnotationChange:{defaultValue:null,description:"",name:"onAnnotationChange",required:!1,type:{name:"((params: IAnnotationEvent) => void)"}},onAnnotationCreated:{defaultValue:null,description:"",name:"onAnnotationCreated",required:!1,type:{name:"((params: IAnnotationEvent) => void)"}},onAnnotationDeleted:{defaultValue:null,description:"",name:"onAnnotationDeleted",required:!1,type:{name:"((params: IAnnotationEvent) => void)"}},onImageChange:{defaultValue:null,description:"",name:"onImageChange",required:!1,type:{name:"((params: IImageChangeEvent) => void)"}},onImageLoadError:{defaultValue:null,description:"",name:"onImageLoadError",required:!1,type:{name:"((error: Error, image: { id: string; src: string; index: number; }) => void)"}}}}}catch(e){}let x={title:"Components/ImageAnnotator",component:f,parameters:{layout:"centered",docs:{description:{component:`
# Image Annotation Editor

A powerful React component for annotating images with shapes, text, and custom tools.

## Features

- 🎯 Auto-incrementing numbered annotations (1-999)
- 🖼️ Multi-image support with navigation
- 🔄 Automatic reuse of deleted annotation numbers
- 🎨 Customizable toolbar with:
  - Rectangle tool
  - Text tool (optional)
  - Eraser tool (optional)
  - Hand tool for navigation
- 📊 Comprehensive event callbacks
- 🖼️ Support for both URL and base64 image sources
- 🔄 Automatic image fitting with aspect ratio preservation
- ⚡ Real-time annotation updates
- 🔒 Locked base image to prevent accidental movement

## Installation

\`\`\`bash
npm install @your-package/image-annotator
\`\`\`

\`\`\`bash
yarn add @your-package/image-annotator
\`\`\`

\`\`\`bash
pnpm add @your-package/image-annotator
\`\`\`

## Basic Usage

\`\`\`tsx
import { ImageAnnotationEditor } from '@your-package/image-annotator'

function App() {
  return (
    <ImageAnnotationEditor
      images={[
        {
          id: 'image1',
          src: 'path/to/image.jpg',
          annotations: []
        }
      ]}
      onDone={(data) => console.log('Annotations:', data)}
    />
  )
}
\`\`\`
        `}}},argTypes:{images:{description:"Array of images with their annotations",control:"object"},tools:{description:"Configuration for annotation tools",control:"object"},outputTriggerOn:{description:"Configure when to trigger output callbacks",control:"object"},initialImageIndex:{description:"Initial image to display (zero-based index)",control:"number"},onAnnotationCreated:{description:"Callback when a new annotation is created",control:!1},onAnnotationChange:{description:"Callback when an annotation is modified",control:!1},onAnnotationDeleted:{description:"Callback when an annotation is deleted",control:!1},onImageChange:{description:"Callback when switching between images",control:!1},onDone:{description:"Callback when annotation is complete",control:!1}},tags:["autodocs"]},y=[{id:"image0",src:"https://fastly.picsum.photos/id/930/900/600.jpg?hmac=-VvyG-XjlLRggW6xtMd4UHBwxXJ-O8g7EVRpKm9DW0s",annotations:[{id:"shape:s-MMqyY_DlysR5i_Dr-cw",x:570.6616220075775,y:234.7749303606369,width:198.69671630859375,height:131.31036376953125,rotation:5.3756140961425345,type:"rectangle",label:"5",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:1-yh2opbFbOpEprcNPdKS",x:83.45930325359515,y:193.02561725714776,width:124.84748947006867,height:123.61206136850944,rotation:5.3756140961425345,type:"rectangle",label:"1",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:Hp9GrZ00ldwLN0CpWkcXY",x:154.38957623531536,y:305.0142249484778,width:248.734083670453,height:229.15347678557805,rotation:0,type:"rectangle",label:"2",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:sw4HvspZ2ScsJ68k6Ejm7",x:451.2897707321237,y:142.1256360707238,width:129.70425985164417,height:108.62586997703193,rotation:5.3930673886624785,type:"rectangle",label:"3",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:cPtiRk5d-0bboKDQSoMO9",x:586.2918704226382,y:368.4326594858195,width:278.90842602679845,height:142.37716236564358,rotation:.29670597283903605,type:"rectangle",label:"4",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}},{id:"shape:5NSqVehqe8IlFmYaW7PsP",x:308.8582223671702,y:260.60060508073525,width:154.5696085710519,height:182.23682110566017,rotation:0,type:"rectangle",label:"6",timestamp:0x194698b888c,metadata:{color:"red",createdBy:"user",modifiedAt:0x194698b888c,version:1,tags:[],isVerified:!1}}]},{id:"image1",src:"https://fastly.picsum.photos/id/106/900/600.jpg?hmac=xA_tP1jGHJrWhLPmViP6lnLck6pqCmDXQP8Q9H1IPgs",annotations:[]},{id:"image2",src:"https://fastly.picsum.photos/id/574/800/601.jpg?hmac=DZb2oYbpWGCSpPwqhs4_H0Uvk2VoizaQWddhQIVhRFE",annotations:[]},{id:"image3",src:"https://fastly.picsum.photos/id/372/800/600.jpg?hmac=911lXwSe0NWznaFWKm3nVrZV7y1IypKxlpDUIVpKxVs",annotations:[]},{id:"image4",src:"https://fastly.picsum.photos/id/1057/800/600.jpg?hmac=YmA5NCeEgXc1TOldOXFtXzaMW1NWH-IG92zNgLmTcDQ",annotations:[]},{id:"image5",src:"https://fastly.picsum.photos/id/705/900/600.jpg?hmac=bzZzT6Zhu_ybVXbEhA8WipVgd9fxGXYNmZgaApMKHBY",annotations:[]}],b=[{id:"image1",src:"https://fastly.picsum.photos/id/727/800/602.jpg?hmac=TXud4Hami5cc6oxCzbuVUHoTIeP-nNVcU8A1VtS11XE",annotations:[{id:"shape:1",x:100,y:100,width:200,height:150,rotation:0,label:"1",timestamp:Date.now(),metadata:{color:"red",createdBy:"user",modifiedAt:Date.now(),version:1,tags:[],isVerified:!1}}]}],v={args:{images:y},parameters:{docs:{description:{story:`
### Basic Example

This is the most basic usage of the Image Annotator component. It shows:
- Loading multiple images
- Basic annotation capabilities
- Default tool configuration
        `}}}},w={args:{images:b}},C={args:{images:y,tools:{eraser:{enabled:!0},text:{enabled:!0}}},parameters:{docs:{description:{story:`
### Custom Tools Example

Demonstrates how to configure custom tools:
\`\`\`tsx
<ImageAnnotationEditor
  tools={{
    eraser: { enabled: true },
    text: { enabled: true }
  }}
/>
\`\`\`
        `}}}},A={args:{images:y,outputTriggerOn:{created:!0,changed:!0,deleted:!0,navigated:!1},onAnnotationCreated:e=>{console.log("Annotation created:",e)},onAnnotationChange:e=>{console.log("Annotation changed:",e)},onAnnotationDeleted:e=>{console.log("Annotation deleted:",e)},onImageChange:e=>{console.log("Image changed:",e)},onDone:e=>{console.log("Done clicked:",e)}},parameters:{docs:{description:{story:`
### Callback Events Example

Shows how to handle various events:
\`\`\`tsx
<ImageAnnotationEditor
  outputTriggerOn={{
    created: true,
    changed: true,
    deleted: true,
    navigated: false
  }}
  onAnnotationCreated={(annotation) => {
    console.log('New annotation:', annotation)
  }}
  onDone={(data) => {
    console.log('Final annotations:', data)
  }}
/>
\`\`\`
        `}}}},I={args:{images:y,outputTriggerOn:{created:!0,changed:!0,deleted:!0,navigated:!0},onDone:e=>{console.log("Auto-triggered on change:",e)}},parameters:{docs:{description:{story:`
### Auto-Trigger Example

Demonstrates automatic triggering of onDone for all possible events:
\`\`\`tsx
<ImageAnnotationEditor
  outputTriggerOn={{
    created: true,
    changed: true,
    deleted: true,
    navigated: true
  }}
  onDone={(data) => {
    console.log('Auto-triggered:', data)
  }}
/>
\`\`\`
        `}}}},E={args:{images:[,,,,,].fill(null).map((e,t)=>({id:`image${t+1}`,src:`https://picsum.photos/800/${600+t}`,annotations:[]})),initialImageIndex:0}},N={args:{images:[{id:"large-image",src:"https://picsum.photos/2000/1500",annotations:[]}]}},j={args:{images:[{id:"small-image",src:"https://picsum.photos/400/300",annotations:[]}]}},S={args:{images:[{id:"small",src:"https://picsum.photos/400/300",annotations:[]},{id:"medium",src:"https://picsum.photos/800/600",annotations:[]},{id:"large",src:"https://picsum.photos/1600/1200",annotations:[]}]}},D={args:{initialImageIndex:1,images:[{id:"valid-image",src:"https://picsum.photos/800/600",annotations:[]},{id:"failed-image",src:"https://invalid-image-url.jpg",annotations:[]},{id:"valid-image",src:"https://picsum.photos/800/600",annotations:[]}]}},V={args:{images:[{id:"image-with-metadata",src:"https://fastly.picsum.photos/id/727/800/602.jpg?hmac=TXud4Hami5cc6oxCzbuVUHoTIeP-nNVcU8A1VtS11XE",annotations:[{id:"shape:custom-metadata",x:100,y:100,width:200,height:150,rotation:0,label:"1",timestamp:Date.now(),metadata:{color:"red",createdBy:"john_doe",modifiedAt:Date.now(),version:2,tags:["important","review-needed"],isVerified:!0,assignedTo:"jane_doe",priority:"high",comments:["Check this region","Needs verification"],customId:"ABC123"}}]}],onAnnotationChange:e=>{console.log("Annotation changed with preserved metadata:",e)},onDone:e=>{console.log("Final data with preserved metadata:",e)}},parameters:{docs:{description:{story:`
### Custom Metadata Example

Demonstrates how custom metadata is preserved when annotations are modified:

\`\`\`tsx
const imageWithMetadata = {
  id: 'image1',
  src: 'image-url',
  annotations: [{
    // ... annotation properties ...
    metadata: {
      color: 'red',
      createdBy: 'john_doe',
      tags: ['important'],
      // Custom fields
      assignedTo: 'jane_doe',
      priority: 'high',
      comments: ['Check this region'],
      customId: 'ABC123'
    }
  }]
}

<ImageAnnotationEditor
  images={[imageWithMetadata]}
  onAnnotationChange={(data) => {
    console.log('Metadata preserved:', data)
  }}
/>
\`\`\`

When modifying annotations, any custom metadata fields will be preserved while still updating standard fields like \`modifiedAt\` and \`color\`.
        `}}}},k=["Basic","WithPreExistingAnnotations","WithCustomTools","WithCallbacks","WithAutoTriggers","WithMultipleImages","WithLargeImage","WithSmallImage","WithMixedSizeImages","WithFailedImageLoad","WithCustomMetadata"];v.parameters={...v.parameters,docs:{...v.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Basic Example\n\nThis is the most basic usage of the Image Annotator component. It shows:\n- Loading multiple images\n- Basic annotation capabilities\n- Default tool configuration\n        `\n      }\n    }\n  }\n}",...v.parameters?.docs?.source}}},w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: imagesWithAnnotations\n  }\n}",...w.parameters?.docs?.source}}},C.parameters={...C.parameters,docs:{...C.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    tools: {\n      eraser: {\n        enabled: true\n      },\n      text: {\n        enabled: true\n      }\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Custom Tools Example\n\nDemonstrates how to configure custom tools:\n\\`\\`\\`tsx\n<ImageAnnotationEditor\n  tools={{\n    eraser: { enabled: true },\n    text: { enabled: true }\n  }}\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}",...C.parameters?.docs?.source}}},A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    outputTriggerOn: {\n      created: true,\n      changed: true,\n      deleted: true,\n      navigated: false\n    },\n    onAnnotationCreated: annotation => {\n      console.log('Annotation created:', annotation);\n    },\n    onAnnotationChange: annotation => {\n      console.log('Annotation changed:', annotation);\n    },\n    onAnnotationDeleted: annotation => {\n      console.log('Annotation deleted:', annotation);\n    },\n    onImageChange: data => {\n      console.log('Image changed:', data);\n    },\n    onDone: data => {\n      console.log('Done clicked:', data);\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Callback Events Example\n\nShows how to handle various events:\n\\`\\`\\`tsx\n<ImageAnnotationEditor\n  outputTriggerOn={{\n    created: true,\n    changed: true,\n    deleted: true,\n    navigated: false\n  }}\n  onAnnotationCreated={(annotation) => {\n    console.log('New annotation:', annotation)\n  }}\n  onDone={(data) => {\n    console.log('Final annotations:', data)\n  }}\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}",...A.parameters?.docs?.source}}},I.parameters={...I.parameters,docs:{...I.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: sampleImages,\n    outputTriggerOn: {\n      created: true,\n      changed: true,\n      deleted: true,\n      navigated: true\n    },\n    onDone: data => {\n      console.log('Auto-triggered on change:', data);\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Auto-Trigger Example\n\nDemonstrates automatic triggering of onDone for all possible events:\n\\`\\`\\`tsx\n<ImageAnnotationEditor\n  outputTriggerOn={{\n    created: true,\n    changed: true,\n    deleted: true,\n    navigated: true\n  }}\n  onDone={(data) => {\n    console.log('Auto-triggered:', data)\n  }}\n/>\n\\`\\`\\`\n        `\n      }\n    }\n  }\n}",...I.parameters?.docs?.source}}},E.parameters={...E.parameters,docs:{...E.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: Array(5).fill(null).map((_, i) => ({\n      id: `image${i + 1}`,\n      src: `https://picsum.photos/800/${600 + i}`,\n      annotations: []\n    })),\n    initialImageIndex: 0\n  }\n}",...E.parameters?.docs?.source}}},N.parameters={...N.parameters,docs:{...N.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'large-image',\n      src: 'https://picsum.photos/2000/1500',\n      annotations: []\n    }]\n  }\n}",...N.parameters?.docs?.source}}},j.parameters={...j.parameters,docs:{...j.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'small-image',\n      src: 'https://picsum.photos/400/300',\n      annotations: []\n    }]\n  }\n}",...j.parameters?.docs?.source}}},S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'small',\n      src: 'https://picsum.photos/400/300',\n      annotations: []\n    }, {\n      id: 'medium',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }, {\n      id: 'large',\n      src: 'https://picsum.photos/1600/1200',\n      annotations: []\n    }]\n  }\n}",...S.parameters?.docs?.source}}},D.parameters={...D.parameters,docs:{...D.parameters?.docs,source:{originalSource:"{\n  args: {\n    initialImageIndex: 1,\n    images: [{\n      id: 'valid-image',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }, {\n      id: 'failed-image',\n      // Using an invalid URL to simulate a failed image load\n      src: 'https://invalid-image-url.jpg',\n      annotations: []\n    }, {\n      id: 'valid-image',\n      src: 'https://picsum.photos/800/600',\n      annotations: []\n    }]\n  }\n}",...D.parameters?.docs?.source}}},V.parameters={...V.parameters,docs:{...V.parameters?.docs,source:{originalSource:"{\n  args: {\n    images: [{\n      id: 'image-with-metadata',\n      src: 'https://fastly.picsum.photos/id/727/800/602.jpg?hmac=TXud4Hami5cc6oxCzbuVUHoTIeP-nNVcU8A1VtS11XE',\n      annotations: [{\n        id: 'shape:custom-metadata',\n        x: 100,\n        y: 100,\n        width: 200,\n        height: 150,\n        rotation: 0,\n        label: '1',\n        timestamp: Date.now(),\n        metadata: {\n          color: 'red',\n          createdBy: 'john_doe',\n          modifiedAt: Date.now(),\n          version: 2,\n          tags: ['important', 'review-needed'],\n          isVerified: true,\n          // Custom metadata fields\n          assignedTo: 'jane_doe',\n          priority: 'high',\n          comments: ['Check this region', 'Needs verification'],\n          customId: 'ABC123'\n        }\n      }]\n    }],\n    onAnnotationChange: data => {\n      console.log('Annotation changed with preserved metadata:', data);\n    },\n    onDone: data => {\n      console.log('Final data with preserved metadata:', data);\n    }\n  },\n  parameters: {\n    docs: {\n      description: {\n        story: `\n### Custom Metadata Example\n\nDemonstrates how custom metadata is preserved when annotations are modified:\n\n\\`\\`\\`tsx\nconst imageWithMetadata = {\n  id: 'image1',\n  src: 'image-url',\n  annotations: [{\n    // ... annotation properties ...\n    metadata: {\n      color: 'red',\n      createdBy: 'john_doe',\n      tags: ['important'],\n      // Custom fields\n      assignedTo: 'jane_doe',\n      priority: 'high',\n      comments: ['Check this region'],\n      customId: 'ABC123'\n    }\n  }]\n}\n\n<ImageAnnotationEditor\n  images={[imageWithMetadata]}\n  onAnnotationChange={(data) => {\n    console.log('Metadata preserved:', data)\n  }}\n/>\n\\`\\`\\`\n\nWhen modifying annotations, any custom metadata fields will be preserved while still updating standard fields like \\`modifiedAt\\` and \\`color\\`.\n        `\n      }\n    }\n  }\n}",...V.parameters?.docs?.source}}}},"./src/components/loading/index.tsx":function(e,t,a){a.d(t,{Z:()=>r});var n=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),o=a("./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs"),i=a("./node_modules/.pnpm/motion@11.18.2_react-dom@18.3.1_react@18.3.1/node_modules/motion/dist/es/framer-motion/dist/es/render/components/motion/proxy.mjs"),s=a("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");function r(e){let{loadingText:t="Loading...",className:a="",content:r="",children:d,isLoading:l=!1,progressInterval:c=100,progressIncrement:m=2,expandDelay:u=300,maxAutoProgress:p=90,autoProgress:g=!0,contentClassName:h="",loadingSpinnerClassName:f="",progressBarClassName:x=""}=e,[y,b]=(0,s.useState)({progress:0,showContent:!1,expanded:!1}),v=(0,s.useRef)(null),[w,C]=(0,s.useState)(0);return(0,s.useEffect)(()=>{l?b({progress:0,showContent:!1,expanded:!1}):(r||d)&&(b(e=>({...e,showContent:!0})),setTimeout(()=>{b(e=>({...e,expanded:!0}))},u))},[l,r,d,u]),(0,s.useEffect)(()=>{if(!g||!l)return;let e=setInterval(()=>{b(e=>({...e,progress:e.progress>=p?p:e.progress+m}))},c);return()=>clearInterval(e)},[l,g,p,m,c]),(0,s.useEffect)(()=>{!l&&y.progress<100&&b(e=>({...e,progress:100}))},[l]),(0,s.useEffect)(()=>{v.current&&C(v.current.scrollHeight+32)},[y.showContent]),(0,n.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,n.jsx)("div",{className:"transition-all duration-500 ease-out transform",children:(0,n.jsx)(i.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:(0,o.W)("relative bg-white overflow-hidden","transition-all duration-500 ease-in-out",y.showContent?"rounded-[16px] border border-[#e5e7eb]":"rounded-2xl border border-[#e5e7eb]",y.expanded?"transform-none":"scale-95 opacity-90","shadow-sm",y.showContent&&"animate-expand-width",a),style:{height:y.expanded?w||"auto":"40px"},children:(0,n.jsx)("div",{className:(0,o.W)("px-6 flex items-center h-full justify-between","transition-all duration-500 ease-in-out",y.showContent&&"animate-slide-content",y.showContent&&"py-4"),children:y.showContent?d?(0,n.jsx)("div",{ref:v,className:(0,o.W)("w-full transition-all duration-500 ease-in-out",y.expanded?"opacity-100":"opacity-0",h),children:d}):r?(0,n.jsx)("div",{ref:v,className:(0,o.W)("w-full transition-all duration-500 ease-in-out",y.expanded?"opacity-100":"opacity-0",h),children:(0,n.jsx)("div",{className:"prose prose-gray max-w-none py-4",children:r.split("\n\n").map((e,t)=>(0,n.jsx)("p",{className:"mb-4 text-[#181b25] leading-relaxed",children:e},t))})}):null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("span",{className:"text-[14px] font-medium text-[#181b25] whitespace-nowrap",children:t})}),(0,n.jsx)(i.E.div,{className:(0,o.W)("h-4 w-4 border-2 border-[#9672e4] border-t-transparent rounded-full ml-3",f),animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),(0,n.jsx)("div",{className:(0,o.W)("absolute bottom-0 left-0 h-[2px] bg-gradient-to-r from-[#9672e4] to-[#e0daff] transition-all duration-100",x),style:{width:`${y.progress}%`}})]})})})})})}try{loading.displayName="loading",loading.__docgenInfo={description:"",displayName:"loading",props:{loadingText:{defaultValue:{value:"Loading..."},description:"Text displayed during the loading state",name:"loadingText",required:!1,type:{name:"string"}},className:{defaultValue:{value:""},description:"Additional className for the main container",name:"className",required:!1,type:{name:"string"}},content:{defaultValue:{value:""},description:"Content to display after loading completes. Can be a string or React nodes",name:"content",required:!1,type:{name:"string"}},children:{defaultValue:null,description:"React nodes to display after loading completes",name:"children",required:!1,type:{name:"ReactNode"}},isLoading:{defaultValue:{value:"false"},description:"Controls the loading state",name:"isLoading",required:!1,type:{name:"boolean"}},progressInterval:{defaultValue:{value:"100"},description:"Interval (in ms) between progress updates. Default: 100",name:"progressInterval",required:!1,type:{name:"number"}},progressIncrement:{defaultValue:{value:"2"},description:"Amount to increment progress by each interval. Default: 2",name:"progressIncrement",required:!1,type:{name:"number"}},expandDelay:{defaultValue:{value:"300"},description:"Delay (in ms) before expanding the container to show content. Default: 300",name:"expandDelay",required:!1,type:{name:"number"}},maxAutoProgress:{defaultValue:{value:"90"},description:"Maximum progress value for auto-progress. Default: 90",name:"maxAutoProgress",required:!1,type:{name:"number"}},autoProgress:{defaultValue:{value:"true"},description:"Enable/disable automatic progress animation. Default: true",name:"autoProgress",required:!1,type:{name:"boolean"}},contentClassName:{defaultValue:{value:""},description:"Additional className for the content container",name:"contentClassName",required:!1,type:{name:"string"}},loadingSpinnerClassName:{defaultValue:{value:""},description:"Additional className for the loading spinner",name:"loadingSpinnerClassName",required:!1,type:{name:"string"}},progressBarClassName:{defaultValue:{value:""},description:"Additional className for the progress bar",name:"progressBarClassName",required:!1,type:{name:"string"}}}}}catch(e){}}}]);